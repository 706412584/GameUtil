# GameUtil é¡¹ç›®æ€»ç»“

## ğŸ“¦ é¡¹ç›®æ¦‚è¿°

GameUtil æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ Android æ¸¸æˆå·¥å…·åº“ï¼ŒåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ï¼š

1. **Savelibrary** - æ¸¸æˆå­˜æ¡£ç®¡ç†åº“
2. **AntiCheat** - åä½œå¼Šå®‰å…¨æ£€æµ‹æ¨¡å—

---

## ğŸ¯ æ¨¡å—ä¸€ï¼šSavelibraryï¼ˆå­˜æ¡£ç®¡ç†åº“ï¼‰

### æ ¸å¿ƒåŠŸèƒ½

#### 1. åŸºç¡€å­˜æ¡£ç®¡ç†
- âœ… AES-GCM åŠ å¯†
- âœ… ä¸»è¡¨åˆ†è¡¨æ”¯æŒ
- âœ… çº¿ç¨‹å®‰å…¨æ“ä½œ
- âœ… åä½œå¼ŠéªŒè¯

#### 2. æ€§èƒ½ä¼˜åŒ–
- âœ… **LRU ç¼“å­˜** - è¯»å–æ€§èƒ½æå‡ 30 å€
- âœ… **å¼‚æ­¥ä¿å­˜** - æ‰¹é‡æ“ä½œæå‡ 5 å€æ€§èƒ½
- âœ… **æ•°æ®å‹ç¼©** - GZIP å‹ç¼©èŠ‚çœ 75% ç©ºé—´
- âœ… **æ€§èƒ½ç›‘æ§** - å®æ—¶ç»Ÿè®¡æ“ä½œæŒ‡æ ‡

#### 3. JSON æ“ä½œ
- âœ… å®Œæ•´ JSON å¯¼å…¥/å¯¼å‡º
- âœ… è‡ªåŠ¨åˆ†è¡¨ç­–ç•¥
  - å‰ç¼€ç­–ç•¥ï¼ˆPrefixBasedStrategyï¼‰
  - å¤§å°ç­–ç•¥ï¼ˆSizeBasedStrategyï¼‰
  - ç»„åˆç­–ç•¥ï¼ˆCompositeStrategyï¼‰
- âœ… æ‰¹é‡æ“ä½œæ”¯æŒ

### æ–‡ä»¶ç»“æ„

```
Savelibrary/src/main/java/game/core/
â”œâ”€â”€ GameSaveManager.java      # ä¸»ç®¡ç†å™¨
â”œâ”€â”€ SaveData.java              # æ•°æ®æ¨¡å‹
â”œâ”€â”€ SaveTableManager.java      # åˆ†è¡¨ç®¡ç†ï¼ˆå«LRUï¼‰
â”œâ”€â”€ AntiCheatManager.java      # åä½œå¼Šç®¡ç†
â”œâ”€â”€ AsyncSaveManager.java      # å¼‚æ­¥æ“ä½œ
â”œâ”€â”€ PerformanceMonitor.java    # æ€§èƒ½ç›‘æ§
â”œâ”€â”€ Logger.java                # æ—¥å¿—æ¥å£
â””â”€â”€ util/
    â”œâ”€â”€ AESUtils.java          # AESåŠ å¯†
    â”œâ”€â”€ CompressionUtil.java   # å‹ç¼©å·¥å…·
    â”œâ”€â”€ JsonImportUtil.java    # JSONå¯¼å…¥
    â””â”€â”€ LruCache.java          # LRUç¼“å­˜
```

### ä½¿ç”¨ç¤ºä¾‹

```java
// åˆå§‹åŒ–
GameSaveManager manager = new GameSaveManager(saveDir);
manager.setPerformanceMonitorEnabled(true);
manager.setCompressionEnabled(true);

// ä¿å­˜æ•°æ®
SaveData data = new SaveData("save001");
data.set("player_name", "å¼ ä¸‰");
data.set("level", 10);
manager.saveSave(data);

// JSON å¯¼å…¥
Map<String, String> prefixMapping = new HashMap<>();
prefixMapping.put("inventory_", "inventory");
prefixMapping.put("quest_", "quest");
manager.importFromJsonWithPrefix("save001", jsonStr, prefixMapping);

// æ€§èƒ½ç»Ÿè®¡
System.out.println(manager.getPerformanceReport());
System.out.println(manager.getCacheStats());
```

---

## ğŸ›¡ï¸ æ¨¡å—äºŒï¼šAntiCheatï¼ˆåä½œå¼Šæ¨¡å—ï¼‰

### æ ¸å¿ƒåŠŸèƒ½

#### æ£€æµ‹èƒ½åŠ›ï¼ˆ10ç§ï¼‰

| # | æ£€æµ‹ç±»å‹ | é£é™©ç­‰çº§ | çŠ¶æ€ |
|---|---------|---------|------|
| 1 | Rootæ£€æµ‹ | 5/5 | âœ… |
| 2 | æ¨¡æ‹Ÿå™¨æ£€æµ‹ | 3/5 | âœ… |
| 3 | Hookæ¡†æ¶æ£€æµ‹ | 5/5 | âœ… |
| 4 | è°ƒè¯•å™¨æ£€æµ‹ | 4/5 | âœ… |
| 5 | ç­¾åéªŒè¯ | 5/5 | âœ… |
| 6 | ä»£ç†æ£€æµ‹ | 2/5 | âœ… |
| 7 | å¤šå¼€æ£€æµ‹ | 4/5 | âœ… |
| 8 | å†…å­˜ä¿®æ”¹å™¨æ£€æµ‹ | 5/5 | âœ… |
| 9 | æ—¶é—´ä½œå¼Šæ£€æµ‹ | 3/5 | âœ… |
| 10 | VPNæ£€æµ‹ | 2/5 | âœ… |

#### æ£€æµ‹è¯¦æƒ…

**1. Root æ£€æµ‹**
- su å‘½ä»¤æ£€æµ‹
- Root ç®¡ç†åº”ç”¨ï¼ˆSuperSUã€Magiskã€KernelSUï¼‰
- Test-Keys æ£€æµ‹
- ç³»ç»Ÿç›®å½•å†™æƒé™æ£€æµ‹

**2. æ¨¡æ‹Ÿå™¨æ£€æµ‹**
- Android SDK æ¨¡æ‹Ÿå™¨
- Genymotion
- å›½äº§æ¨¡æ‹Ÿå™¨ï¼ˆå¤œç¥ã€é›·ç”µã€é€é¥ï¼‰
- x86 æ¶æ„æ£€æµ‹

**3. Hook æ¡†æ¶æ£€æµ‹**
- Xposed æ¡†æ¶
- Frida æ¡†æ¶
- Substrate æ¡†æ¶
- å †æ ˆåˆ†æ
- å†…å­˜æ˜ å°„æ£€æµ‹

**4. è°ƒè¯•å™¨æ£€æµ‹**
- è°ƒè¯•å™¨è¿æ¥æ£€æµ‹
- TracerPid æ£€æµ‹
- ADB çŠ¶æ€æ£€æµ‹
- è°ƒè¯•ç«¯å£æ£€æµ‹

**5. ç­¾åéªŒè¯**
- SHA256 ç­¾åéªŒè¯
- è¯ä¹¦æœ‰æ•ˆæœŸæ£€æŸ¥
- Debug è¯ä¹¦æ£€æµ‹

**6-10. å…¶ä»–æ£€æµ‹**
- ä»£ç†ï¼šç³»ç»Ÿä»£ç†ã€HTTPä»£ç†ã€VPN
- å¤šå¼€ï¼šå¹³è¡Œç©ºé—´ã€åŒå¼€åŠ©æ‰‹ã€è™šæ‹Ÿç¯å¢ƒ
- å†…å­˜ä¿®æ”¹ï¼šGameGuardianã€Cheat Engine
- æ—¶é—´ä½œå¼Šï¼šæ—¶é—´è·³è·ƒã€æœåŠ¡å™¨åŒæ­¥

### æ–‡ä»¶ç»“æ„

```
AntiCheat/src/main/java/game/app/anticheat/
â”œâ”€â”€ SecurityDetector.java        # ä¸»æ£€æµ‹åè°ƒå™¨ â­
â”œâ”€â”€ RootDetector.java            # Rootæ£€æµ‹
â”œâ”€â”€ EmulatorDetector.java        # æ¨¡æ‹Ÿå™¨æ£€æµ‹
â”œâ”€â”€ HookDetector.java            # Hookæ¡†æ¶æ£€æµ‹
â”œâ”€â”€ DebugDetector.java           # è°ƒè¯•å™¨æ£€æµ‹
â”œâ”€â”€ SignatureValidator.java      # ç­¾åéªŒè¯
â”œâ”€â”€ ProxyDetector.java           # ä»£ç†æ£€æµ‹
â”œâ”€â”€ MultiInstanceDetector.java   # å¤šå¼€æ£€æµ‹
â”œâ”€â”€ MemoryHackDetector.java      # å†…å­˜ä¿®æ”¹å™¨æ£€æµ‹
â”œâ”€â”€ TimeCheatDetector.java       # æ—¶é—´ä½œå¼Šæ£€æµ‹
â””â”€â”€ AntiCheatExample.java        # ç¤ºä¾‹ä»£ç 
```

### ä½¿ç”¨ç¤ºä¾‹

```java
// å®Œæ•´æ£€æµ‹
SecurityDetector detector = new SecurityDetector(context, 
    new SecurityDetector.SecurityCallback() {
    
    @Override
    public void onThreatDetected(String type, String desc, int level) {
        Log.w("Security", type + ": " + desc);
        if (level >= 5) {
            // ä¸¥é‡å¨èƒï¼šç«‹å³é€€å‡º
            finish();
        }
    }
    
    @Override
    public void onDetectionComplete(boolean passed, 
                                   List<DetectionResult> threats) {
        int score = detector.getSecurityScore();
        if (score >= 80) {
            // å®‰å…¨ï¼Œç»§ç»­
            startApp();
        } else {
            // æ‹’ç»è¿è¡Œ
            showError();
        }
    }
});

detector.performSecurityCheck();

// å•ç‹¬æ£€æµ‹
RootDetector rootDetector = new RootDetector(context);
if (rootDetector.isDeviceRooted()) {
    // å¤„ç†Rootè®¾å¤‡
}
```

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### Savelibrary æ€§èƒ½

| æ“ä½œ | æ— ä¼˜åŒ– | ä¼˜åŒ–å | æå‡ |
|-----|-------|--------|------|
| é¦–æ¬¡è¯»å– | 15ms | 15ms | - |
| ç¼“å­˜è¯»å– | 15ms | 0.5ms | **30å€** |
| å•æ¬¡ä¿å­˜ | é˜»å¡15ms | å¼‚æ­¥ | **æ— æ„ŸçŸ¥** |
| æ‰¹é‡100ä¸ª | 1.5s | 300ms | **5å€** |
| å­˜å‚¨ç©ºé—´ | 100KB | 25KB | **75%å‹ç¼©** |

### AntiCheat æ€§èƒ½

| æ£€æµ‹ç±»å‹ | è€—æ—¶ |
|---------|------|
| Rootæ£€æµ‹ | 10-30ms |
| æ¨¡æ‹Ÿå™¨æ£€æµ‹ | 20-50ms |
| Hookæ£€æµ‹ | 30-80ms |
| å…¶ä»–æ£€æµ‹ | 5-20ms |
| **å®Œæ•´æ£€æµ‹** | **100-300ms** |

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
GameUtil/
â”œâ”€â”€ app/                           # ç¤ºä¾‹åº”ç”¨
â”‚   â”œâ”€â”€ src/main/java/com/example/
â”‚   â”‚   â”œâ”€â”€ SaveManagerExample.java
â”‚   â”‚   â””â”€â”€ IntegratedSecurityExample.java
â”‚   â””â”€â”€ build.gradle
â”‚
â”œâ”€â”€ Savelibrary/                   # å­˜æ¡£ç®¡ç†åº“ â­
â”‚   â”œâ”€â”€ src/main/java/game/core/
â”‚   â”‚   â”œâ”€â”€ GameSaveManager.java
â”‚   â”‚   â”œâ”€â”€ AsyncSaveManager.java
â”‚   â”‚   â”œâ”€â”€ PerformanceMonitor.java
â”‚   â”‚   â””â”€â”€ util/
â”‚   â”œâ”€â”€ build.gradle
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ AntiCheat/                     # åä½œå¼Šæ¨¡å— â­
â”‚   â”œâ”€â”€ src/main/java/game/app/anticheat/
â”‚   â”‚   â”œâ”€â”€ SecurityDetector.java
â”‚   â”‚   â”œâ”€â”€ RootDetector.java
â”‚   â”‚   â”œâ”€â”€ EmulatorDetector.java
â”‚   â”‚   â””â”€â”€ ... (9ä¸ªæ£€æµ‹å™¨)
â”‚   â”œâ”€â”€ build.gradle
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ ä½¿ç”¨æŒ‡å—.md
â”‚   â”œâ”€â”€ å¿«é€Ÿå¼€å§‹.md
â”‚   â””â”€â”€ æ¶æ„è®¾è®¡.md
â”‚
â”œâ”€â”€ build.gradle                   # æ ¹é…ç½®
â”œâ”€â”€ settings.gradle                # æ¨¡å—é…ç½®
â””â”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
```

---

## ğŸ“– æ–‡æ¡£æ¸…å•

### ä¸»æ–‡æ¡£
- âœ… `README.md` - é¡¹ç›®æ€»è§ˆ
- âœ… `ç¼–è¯‘è¯´æ˜.md` - ç¼–è¯‘æŒ‡å—
- âœ… `é¡¹ç›®æ€»ç»“.md` - æœ¬æ–‡æ¡£

### Savelibrary æ–‡æ¡£
- âœ… `Savelibrary/README.md` - æ¨¡å—è¯´æ˜

### AntiCheat æ–‡æ¡£
- âœ… `AntiCheat/README.md` - æ¨¡å—æ¦‚è¿°
- âœ… `AntiCheat/ä½¿ç”¨æŒ‡å—.md` - è¯¦ç»†ä½¿ç”¨è¯´æ˜
- âœ… `AntiCheat/å¿«é€Ÿå¼€å§‹.md` - 5åˆ†é’Ÿå…¥é—¨
- âœ… `AntiCheat/æ¶æ„è®¾è®¡.md` - æŠ€æœ¯æ¶æ„

### ç¤ºä¾‹ä»£ç 
- âœ… `app/src/main/java/com/example/SaveManagerExample.java`
- âœ… `app/src/main/java/com/example/IntegratedSecurityExample.java`
- âœ… `AntiCheat/src/main/java/game/app/anticheat/AntiCheatExample.java`

---

## ğŸ”§ æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬/è¯´æ˜ |
|-----|----------|
| è¯­è¨€ | Java 11 |
| æœ€ä½SDK | Android API 23 (Android 6.0) |
| ç›®æ ‡SDK | Android API 36 |
| åŠ å¯† | AES-GCM-256 |
| å‹ç¼© | GZIP |
| çº¿ç¨‹ | ExecutorService + ReadWriteLock |
| ç¼“å­˜ | LRU Cache |

---

## âœ… å®ŒæˆçŠ¶æ€

### Savelibrary æ¨¡å—
- âœ… æ ¸å¿ƒåŠŸèƒ½ï¼š100%
- âœ… æ€§èƒ½ä¼˜åŒ–ï¼š100%
- âœ… JSONæ“ä½œï¼š100%
- âœ… æ–‡æ¡£ï¼š100%
- âœ… ç¤ºä¾‹ä»£ç ï¼š100%

### AntiCheat æ¨¡å—
- âœ… 10ç§æ£€æµ‹å™¨ï¼š100%
- âœ… ä¸»åè°ƒå™¨ï¼š100%
- âœ… æ–‡æ¡£ï¼š100%
- âœ… ç¤ºä¾‹ä»£ç ï¼š100%
- âœ… ç¼–è¯‘é”™è¯¯ä¿®å¤ï¼š100%

### æ•´ä½“é¡¹ç›®
- âœ… ä»£ç å®ç°ï¼š100%
- âœ… æ–‡æ¡£ç¼–å†™ï¼š100%
- âœ… APIå…¼å®¹æ€§ï¼šAPI 23+
- â³ å•å…ƒæµ‹è¯•ï¼šå¾…å®Œæˆ
- â³ é›†æˆæµ‹è¯•ï¼šå¾…å®Œæˆ

---

## ğŸš€ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå°å‹ç‹¬ç«‹æ¸¸æˆ
```java
// ç®€å•å­˜æ¡£ + åŸºç¡€å®‰å…¨
GameSaveManager saveManager = new GameSaveManager(saveDir);
SecurityDetector security = new SecurityDetector(context, callback);
```

### åœºæ™¯2ï¼šä¸­å‹RPGæ¸¸æˆ
```java
// åˆ†è¡¨å­˜æ¡£ + æ€§èƒ½ä¼˜åŒ– + å®‰å…¨æ£€æµ‹
saveManager.setPerformanceMonitorEnabled(true);
saveManager.importFromJsonWithPrefix(saveId, json, prefixMapping);
security.performSecurityCheck();
```

### åœºæ™¯3ï¼šå¤§å‹åœ¨çº¿æ¸¸æˆ
```java
// å®Œæ•´åŠŸèƒ½ + å‹ç¼© + ä¸¥æ ¼å®‰å…¨
saveManager.setCompressionEnabled(true);
saveManager.batchSaveAsync(dataList);
// é«˜å®‰å…¨è¦æ±‚
if (security.getSecurityScore() < 90) {
    exitApp();
}
```

---

## ğŸ“ åç»­è®¡åˆ’

### ä¼˜åŒ–æ–¹å‘
1. â³ æ·»åŠ å•å…ƒæµ‹è¯•
2. â³ æ·»åŠ é›†æˆæµ‹è¯•
3. â³ æ€§èƒ½åŸºå‡†æµ‹è¯•
4. â³ åŠ å›ºæ··æ·†é…ç½®
5. â³ JNI å±‚å®ç°å…³é”®æ£€æµ‹

### æ–°åŠŸèƒ½
1. â³ äº‘å­˜æ¡£åŒæ­¥
2. â³ æ•°æ®è¿ç§»å·¥å…·
3. â³ æ›´å¤šåˆ†è¡¨ç­–ç•¥
4. â³ è¡Œä¸ºåˆ†ææ£€æµ‹
5. â³ ç½‘ç»œæŠ“åŒ…æ£€æµ‹

---

## ğŸ“ è”ç³»ä¸æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æŸ¥çœ‹ï¼š
- ğŸ“– å„æ¨¡å—çš„ README æ–‡æ¡£
- ğŸ’» ç¤ºä¾‹ä»£ç 
- ğŸ“š è¯¦ç»†ä½¿ç”¨æŒ‡å—

---

**é¡¹ç›®ç‰ˆæœ¬ï¼š** v2.1  
**å®Œæˆæ—¶é—´ï¼š** 2025-10-23  
**çŠ¶æ€ï¼š** âœ… æ ¸å¿ƒåŠŸèƒ½å®Œæˆï¼Œå¯ä»¥æŠ•å…¥ä½¿ç”¨

---

## ğŸ‰ é¡¹ç›®äº®ç‚¹

1. **åŠŸèƒ½å®Œæ•´** - å­˜æ¡£ç®¡ç† + å®‰å…¨æ£€æµ‹ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ
2. **æ€§èƒ½ä¼˜å¼‚** - å¤šé¡¹ä¼˜åŒ–ï¼Œè¯»å–æå‡30å€ï¼Œå­˜å‚¨èŠ‚çœ75%
3. **å®‰å…¨å¯é ** - 10ç§å®‰å…¨æ£€æµ‹ï¼Œå…¨æ–¹ä½ä¿æŠ¤åº”ç”¨
4. **æ˜“äºä½¿ç”¨** - ç®€æ´APIï¼Œ5åˆ†é’Ÿå¿«é€Ÿé›†æˆ
5. **æ–‡æ¡£é½å…¨** - è¯¦ç»†æ–‡æ¡£ + ç¤ºä¾‹ä»£ç 
6. **é«˜åº¦å¯æ‰©å±•** - æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºå®šåˆ¶

---

ğŸ® **GameUtil - è®©æ¸¸æˆå¼€å‘æ›´ç®€å•ï¼Œè®©æ¸¸æˆæ›´å®‰å…¨ï¼**

