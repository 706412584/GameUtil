# Android åä½œå¼Šæ¨¡å—ä½¿ç”¨æŒ‡å—

## ç›®å½•
- [ç®€ä»‹](#ç®€ä»‹)
- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [è¯¦ç»†ä½¿ç”¨](#è¯¦ç»†ä½¿ç”¨)
- [æ£€æµ‹åŸç†](#æ£€æµ‹åŸç†)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

## ç®€ä»‹

Android åä½œå¼Šæ¨¡å—æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åº”ç”¨å®‰å…¨æ£€æµ‹åº“ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ£€æµ‹å’Œé˜²æ­¢å¸¸è§çš„ç ´è§£ã€ä½œå¼Šå’Œç¯¡æ”¹è¡Œä¸ºã€‚

### é€‚ç”¨åœºæ™¯

- ğŸ® æ¸¸æˆåº”ç”¨é˜²ä½œå¼Š
- ğŸ’° é‡‘èåº”ç”¨å®‰å…¨æ£€æµ‹
- ğŸ“± åº”ç”¨é˜²ç¯¡æ”¹ä¿æŠ¤
- ğŸ” æ•æ„Ÿæ•°æ®ä¿æŠ¤

## æ ¸å¿ƒåŠŸèƒ½

### 1. Root æ£€æµ‹

**æ£€æµ‹æ–¹æ³•ï¼š**
- âœ… æ£€æµ‹ su å‘½ä»¤æ˜¯å¦å­˜åœ¨
- âœ… æ£€æµ‹ Root ç®¡ç†åº”ç”¨ï¼ˆSuperSUã€Magiskã€KernelSUï¼‰
- âœ… æ£€æµ‹ Root éšè—å·¥å…·
- âœ… æ£€æµ‹ Test-Keys
- âœ… æ£€æµ‹ BusyBox
- âœ… æ£€æµ‹ç³»ç»Ÿç›®å½•å¯å†™æ€§

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
RootDetector rootDetector = new RootDetector(context);
if (rootDetector.isDeviceRooted()) {
    String details = rootDetector.getRootDetails();
    Log.w("Security", "æ£€æµ‹åˆ°Root: " + details);
    // å¤„ç†é€»è¾‘ï¼šé€€å‡ºåº”ç”¨æˆ–é™åˆ¶åŠŸèƒ½
}
```

**é£é™©ç­‰çº§ï¼š** âš ï¸âš ï¸âš ï¸âš ï¸âš ï¸ (5/5)

**åº”å¯¹ç­–ç•¥ï¼š**
- ä¸¥é‡åœºæ™¯ï¼šç›´æ¥é€€å‡ºåº”ç”¨
- ä¸€èˆ¬åœºæ™¯ï¼šè­¦å‘Šå¹¶é™åˆ¶æ•æ„ŸåŠŸèƒ½
- å®½æ¾åœºæ™¯ï¼šä»…è®°å½•æ—¥å¿—

---

### 2. æ¨¡æ‹Ÿå™¨æ£€æµ‹

**æ£€æµ‹æ–¹æ³•ï¼š**
- âœ… æ£€æµ‹ Build ä¿¡æ¯ç‰¹å¾
- âœ… æ£€æµ‹ QEMU ç‰¹å¾æ–‡ä»¶
- âœ… æ£€æµ‹ Genymotion
- âœ… æ£€æµ‹å›½äº§æ¨¡æ‹Ÿå™¨ï¼ˆå¤œç¥ã€é›·ç”µã€é€é¥ç­‰ï¼‰
- âœ… æ£€æµ‹ x86 æ¶æ„
- âœ… æ£€æµ‹è¿è¥å•†åç§°å¼‚å¸¸

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
EmulatorDetector emulatorDetector = new EmulatorDetector(context);
if (emulatorDetector.isEmulator()) {
    String details = emulatorDetector.getEmulatorDetails();
    Log.w("Security", "æ£€æµ‹åˆ°æ¨¡æ‹Ÿå™¨: " + details);
}
```

**é£é™©ç­‰çº§ï¼š** âš ï¸âš ï¸âš ï¸ (3/5)

**åº”å¯¹ç­–ç•¥ï¼š**
- æ¸¸æˆåº”ç”¨ï¼šé™åˆ¶åŠŸèƒ½æˆ–æé«˜é£æ§
- æ™®é€šåº”ç”¨ï¼šä»…è®°å½•ï¼Œå…è®¸ä½¿ç”¨

---

### 3. Hook æ¡†æ¶æ£€æµ‹

**æ£€æµ‹æ–¹æ³•ï¼š**
- âœ… æ£€æµ‹ Xposed æ¡†æ¶
- âœ… æ£€æµ‹ Frida æ¡†æ¶
- âœ… æ£€æµ‹ Substrate
- âœ… æ£€æµ‹ Virtual Xposed
- âœ… æ£€æµ‹å†…å­˜ä¸­çš„ Hook åº“
- âœ… æ£€æµ‹å †æ ˆå¼‚å¸¸
- âœ… æ£€æµ‹ Frida ç«¯å£

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
HookDetector hookDetector = new HookDetector(context);
if (hookDetector.detectHookFramework()) {
    String details = hookDetector.getHookDetails();
    Log.e("Security", "æ£€æµ‹åˆ°Hookæ¡†æ¶: " + details);
    // ä¸¥é‡å¨èƒï¼Œå»ºè®®é€€å‡º
}
```

**é£é™©ç­‰çº§ï¼š** âš ï¸âš ï¸âš ï¸âš ï¸âš ï¸ (5/5)

**åº”å¯¹ç­–ç•¥ï¼š**
- **å¿…é¡»é€€å‡ºåº”ç”¨**
- Hook æ¡†æ¶å¯ä»¥å®Œå…¨æ§åˆ¶åº”ç”¨è¡Œä¸º

---

### 4. è°ƒè¯•å™¨æ£€æµ‹

**æ£€æµ‹æ–¹æ³•ï¼š**
- âœ… æ£€æµ‹è°ƒè¯•å™¨è¿æ¥
- âœ… æ£€æµ‹ Debug æ ‡å¿—
- âœ… æ£€æµ‹ TracerPid
- âœ… æ£€æµ‹è°ƒè¯•ç«¯å£
- âœ… æ£€æµ‹ ADB çŠ¶æ€

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
DebugDetector debugDetector = new DebugDetector(context);
if (debugDetector.isBeingDebugged()) {
    String details = debugDetector.getDebugDetails();
    Log.w("Security", "æ£€æµ‹åˆ°è°ƒè¯•å™¨: " + details);
}
```

**é£é™©ç­‰çº§ï¼š** âš ï¸âš ï¸âš ï¸âš ï¸ (4/5)

**åº”å¯¹ç­–ç•¥ï¼š**
- Release ç‰ˆæœ¬ï¼šä¸¥æ ¼ç¦æ­¢
- Debug ç‰ˆæœ¬ï¼šå…è®¸è°ƒè¯•

---

### 5. ç­¾åéªŒè¯

**æ£€æµ‹æ–¹æ³•ï¼š**
- âœ… éªŒè¯åº”ç”¨ç­¾å SHA256
- âœ… æ£€æµ‹äºŒæ¬¡æ‰“åŒ…
- âœ… éªŒè¯è¯ä¹¦æœ‰æ•ˆæœŸ
- âœ… æ£€æµ‹ Debug è¯ä¹¦

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
SignatureValidator validator = new SignatureValidator(context);

// è·å–å½“å‰ç­¾åï¼ˆå¼€å‘é˜¶æ®µï¼‰
String currentSig = validator.getCurrentSignatureSHA256();
Log.i("Signature", "å½“å‰ç­¾å: " + currentSig);

// è®¾ç½®æœŸæœ›ç­¾åå¹¶éªŒè¯ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
validator.setExpectedSignature("YOUR_RELEASE_SIGNATURE_SHA256");
if (!validator.verifySignature()) {
    String details = validator.getSignatureDetails();
    Log.e("Security", "ç­¾åéªŒè¯å¤±è´¥: " + details);
    // åº”ç”¨è¢«ç¯¡æ”¹ï¼Œå¿…é¡»é€€å‡º
}
```

**é£é™©ç­‰çº§ï¼š** âš ï¸âš ï¸âš ï¸âš ï¸âš ï¸ (5/5)

**åº”å¯¹ç­–ç•¥ï¼š**
- **å¿…é¡»é€€å‡ºåº”ç”¨**
- ç­¾åä¸åŒ¹é…è¯´æ˜åº”ç”¨è¢«é‡æ–°æ‰“åŒ…

**è·å–ç­¾åæ–¹æ³•ï¼š**
```bash
# ä½¿ç”¨ keytool
keytool -list -v -keystore your.keystore

# æˆ–åœ¨ä»£ç ä¸­è·å–
SignatureValidator validator = new SignatureValidator(context);
String signature = validator.getCurrentSignatureSHA256();
```

---

### 6. ä»£ç†æ£€æµ‹

**æ£€æµ‹æ–¹æ³•ï¼š**
- âœ… æ£€æµ‹ç³»ç»Ÿä»£ç†
- âœ… æ£€æµ‹ HTTP ä»£ç†
- âœ… æ£€æµ‹ VPN è¿æ¥

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
ProxyDetector proxyDetector = new ProxyDetector(context);
if (proxyDetector.isProxySet()) {
    String details = proxyDetector.getProxyDetails();
    Log.w("Security", "æ£€æµ‹åˆ°ä»£ç†: " + details);
}
```

**é£é™©ç­‰çº§ï¼š** âš ï¸âš ï¸ (2/5)

**åº”å¯¹ç­–ç•¥ï¼š**
- é‡‘èåº”ç”¨ï¼šç¦æ­¢ä»£ç†
- æ™®é€šåº”ç”¨ï¼šä»…è®°å½•

---

### 7. å¤šå¼€æ£€æµ‹

**æ£€æµ‹æ–¹æ³•ï¼š**
- âœ… æ£€æµ‹å¹³è¡Œç©ºé—´
- âœ… æ£€æµ‹åŒå¼€åŠ©æ‰‹
- âœ… æ£€æµ‹ VirtualApp
- âœ… æ£€æµ‹æ•°æ®è·¯å¾„å¼‚å¸¸
- âœ… æ£€æµ‹å¤šè¿›ç¨‹å®ä¾‹

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
MultiInstanceDetector multiDetector = new MultiInstanceDetector(context);
if (multiDetector.isRunningInVirtualApp()) {
    String details = multiDetector.getMultiInstanceDetails();
    Log.w("Security", "æ£€æµ‹åˆ°å¤šå¼€: " + details);
}
```

**é£é™©ç­‰çº§ï¼š** âš ï¸âš ï¸âš ï¸âš ï¸ (4/5)

**åº”å¯¹ç­–ç•¥ï¼š**
- æ¸¸æˆï¼šä¸¥æ ¼ç¦æ­¢
- ç¤¾äº¤åº”ç”¨ï¼šå¯èƒ½å…è®¸

---

### 8. å†…å­˜ä¿®æ”¹å™¨æ£€æµ‹

**æ£€æµ‹æ–¹æ³•ï¼š**
- âœ… æ£€æµ‹ GameGuardian
- âœ… æ£€æµ‹ Cheat Engine
- âœ… æ£€æµ‹ GameKiller
- âœ… æ£€æµ‹å†…å­˜æ˜ å°„å¼‚å¸¸
- âœ… æ£€æµ‹å¯ç–‘è¿›ç¨‹

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
MemoryHackDetector memoryDetector = new MemoryHackDetector(context);
if (memoryDetector.detectMemoryHackTools()) {
    String details = memoryDetector.getMemoryHackDetails();
    Log.e("Security", "æ£€æµ‹åˆ°å†…å­˜ä¿®æ”¹å·¥å…·: " + details);
    // ä¸¥é‡å¨èƒï¼Œç«‹å³é€€å‡º
}
```

**é£é™©ç­‰çº§ï¼š** âš ï¸âš ï¸âš ï¸âš ï¸âš ï¸ (5/5)

**åº”å¯¹ç­–ç•¥ï¼š**
- **å¿…é¡»é€€å‡ºåº”ç”¨**
- å¯ä»¥ä»»æ„ä¿®æ”¹æ¸¸æˆæ•°å€¼

---

### 9. æ—¶é—´ä½œå¼Šæ£€æµ‹

**æ£€æµ‹æ–¹æ³•ï¼š**
- âœ… æ£€æµ‹ç³»ç»Ÿæ—¶é—´è·³è·ƒ
- âœ… æ£€æµ‹å¯åŠ¨æ—¶é—´å¼‚å¸¸
- âœ… æœåŠ¡å™¨æ—¶é—´åŒæ­¥éªŒè¯

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```java
TimeCheatDetector timeDetector = new TimeCheatDetector(context);

// è®¾ç½®æœåŠ¡å™¨æ—¶é—´
long serverTime = getServerTime(); // ä»æœåŠ¡å™¨è·å–
timeDetector.setServerTime(serverTime);

// æ£€æµ‹æ—¶é—´ä½œå¼Š
if (timeDetector.detectTimeManipulation()) {
    String details = timeDetector.getTimeCheatDetails();
    Log.w("Security", "æ£€æµ‹åˆ°æ—¶é—´ä¿®æ”¹: " + details);
    
    // è·å–æ—¶é—´åå·®
    long diff = timeDetector.getTimeDifference();
    Log.i("TimeDiff", "æ—¶é—´åå·®: " + diff + "ms");
}
```

**é£é™©ç­‰çº§ï¼š** âš ï¸âš ï¸âš ï¸ (3/5)

**åº”å¯¹ç­–ç•¥ï¼š**
- æ—¶é—´æ•æ„Ÿåº”ç”¨ï¼šä¸¥æ ¼ç¦æ­¢
- æ™®é€šåº”ç”¨ï¼šæ ¡æ­£æ—¶é—´åç»§ç»­

---

## å¿«é€Ÿå¼€å§‹

### 1. é›†æˆæ¨¡å—

åœ¨ `settings.gradle` ä¸­æ·»åŠ ï¼š
```gradle
include ':AntiCheat'
```

åœ¨åº”ç”¨æ¨¡å—çš„ `build.gradle` ä¸­æ·»åŠ ï¼š
```gradle
dependencies {
    implementation project(':AntiCheat')
}
```

### 2. åŸºç¡€ç”¨æ³•

```java
public class MainActivity extends Activity {
    
    private SecurityDetector securityDetector;
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        
        // åˆå§‹åŒ–å®‰å…¨æ£€æµ‹å™¨
        initSecurityDetector();
        
        // æ‰§è¡Œæ£€æµ‹
        securityDetector.performSecurityCheck();
    }
    
    private void initSecurityDetector() {
        securityDetector = new SecurityDetector(this, 
            new SecurityDetector.SecurityCallback() {
            
            @Override
            public void onThreatDetected(String threatType, 
                                       String description, 
                                       int riskLevel) {
                // å®æ—¶å¨èƒé€šçŸ¥
                Log.w("Security", String.format(
                    "[%s] %s (é£é™©:%d)", 
                    threatType, description, riskLevel
                ));
            }
            
            @Override
            public void onDetectionComplete(boolean passed, 
                                           List<DetectionResult> threats) {
                // æ£€æµ‹å®Œæˆå¤„ç†
                handleSecurityResult(passed, threats);
            }
        });
    }
    
    private void handleSecurityResult(boolean passed, 
                                      List<DetectionResult> threats) {
        if (!passed) {
            // æœªé€šè¿‡å®‰å…¨æ£€æµ‹
            showSecurityWarning(threats);
        } else {
            // é€šè¿‡æ£€æµ‹
            continueNormalFlow();
        }
    }
}
```

### 3. è·å–å®‰å…¨æŠ¥å‘Š

```java
// è·å–å®‰å…¨åˆ†æ•° (0-100)
int score = securityDetector.getSecurityScore();

// ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
String report = securityDetector.generateSecurityReport();
System.out.println(report);

// è¾“å‡ºç¤ºä¾‹ï¼š
// === å®‰å…¨æ£€æµ‹æŠ¥å‘Š ===
//
// å®‰å…¨åˆ†æ•°: 75/100
//
// æ£€æµ‹é¡¹ç›®:
// - ROOT: âœ… é€šè¿‡
// - EMULATOR: âŒ æ£€æµ‹åˆ°
//   é£é™©ç­‰çº§: 3/5
//   è¯¦æƒ…: Buildä¿¡æ¯ç‰¹å¾: Android SDK built for x86
// - HOOK: âœ… é€šè¿‡
// ...
```

## è¯¦ç»†ä½¿ç”¨

### å®Œæ•´æ£€æµ‹æµç¨‹

```java
public class SecurityManager {
    
    private SecurityDetector securityDetector;
    private Context context;
    
    public void performFullSecurityCheck() {
        // 1. åˆ›å»ºæ£€æµ‹å™¨
        securityDetector = new SecurityDetector(context, callback);
        
        // 2. æ‰§è¡Œæ£€æµ‹
        securityDetector.performSecurityCheck();
        
        // 3. ç­‰å¾…ç»“æœï¼ˆå¼‚æ­¥ï¼‰
        // ç»“æœä¼šé€šè¿‡å›è°ƒè¿”å›
    }
    
    private SecurityDetector.SecurityCallback callback = 
        new SecurityDetector.SecurityCallback() {
        
        @Override
        public void onThreatDetected(String threatType, 
                                   String description, 
                                   int riskLevel) {
            // å®æ—¶å¤„ç†æ¯ä¸ªå¨èƒ
            handleThreat(threatType, riskLevel);
        }
        
        @Override
        public void onDetectionComplete(boolean passed, 
                                       List<DetectionResult> threats) {
            // æ±‡æ€»å¤„ç†
            processResults(passed, threats);
        }
    };
    
    private void handleThreat(String type, int level) {
        // æ ¹æ®å¨èƒç±»å‹å’Œç­‰çº§å¤„ç†
        switch (level) {
            case 5: // ä¸¥é‡
                reportToServer(type, level);
                exitApp();
                break;
            case 4: // é«˜
                reportToServer(type, level);
                showWarning();
                break;
            case 3: // ä¸­
                reportToServer(type, level);
                break;
            default: // ä½
                logLocally(type, level);
                break;
        }
    }
    
    private void processResults(boolean passed, 
                               List<DetectionResult> threats) {
        // ç”ŸæˆæŠ¥å‘Š
        String report = securityDetector.generateSecurityReport();
        
        // ä¸ŠæŠ¥æœåŠ¡å™¨
        uploadSecurityReport(report);
        
        // æœ¬åœ°è®°å½•
        saveSecurityLog(report);
        
        // UI åé¦ˆ
        if (!passed) {
            showSecurityDialog(threats);
        }
    }
}
```

### è‡ªå®šä¹‰æ£€æµ‹ç­–ç•¥

```java
public class CustomSecurityCheck {
    
    // ç­–ç•¥1ï¼šä»…æ£€æµ‹å…³é”®å¨èƒ
    public boolean checkCriticalThreats(Context context) {
        // åªæ£€æµ‹é£é™©ç­‰çº§ >= 4 çš„å¨èƒ
        RootDetector rootDetector = new RootDetector(context);
        HookDetector hookDetector = new HookDetector(context);
        MemoryHackDetector memDetector = new MemoryHackDetector(context);
        SignatureValidator sigValidator = new SignatureValidator(context);
        
        return rootDetector.isDeviceRooted()
            || hookDetector.detectHookFramework()
            || memDetector.detectMemoryHackTools()
            || !sigValidator.verifySignature();
    }
    
    // ç­–ç•¥2ï¼šåˆ†çº§æ£€æµ‹
    public SecurityLevel getSecurityLevel(Context context) {
        SecurityDetector detector = new SecurityDetector(context, null);
        detector.performSecurityCheck();
        
        int score = detector.getSecurityScore();
        
        if (score >= 90) return SecurityLevel.SAFE;
        if (score >= 70) return SecurityLevel.WARNING;
        if (score >= 50) return SecurityLevel.DANGER;
        return SecurityLevel.CRITICAL;
    }
    
    // ç­–ç•¥3ï¼šå®šæœŸåå°æ£€æµ‹
    public void startPeriodicCheck(Context context) {
        Handler handler = new Handler(Looper.getMainLooper());
        Runnable checkTask = new Runnable() {
            @Override
            public void run() {
                performBackgroundCheck(context);
                // æ¯5åˆ†é’Ÿæ£€æµ‹ä¸€æ¬¡
                handler.postDelayed(this, 5 * 60 * 1000);
            }
        };
        handler.post(checkTask);
    }
    
    private void performBackgroundCheck(Context context) {
        // åå°æ£€æµ‹ï¼ˆä¸é˜»å¡UIï¼‰
        new Thread(() -> {
            SecurityDetector detector = new SecurityDetector(
                context, 
                createSilentCallback()
            );
            detector.performSecurityCheck();
        }).start();
    }
}
```

## æ£€æµ‹åŸç†

### Root æ£€æµ‹åŸç†

1. **su å‘½ä»¤æ£€æµ‹**
   - æ£€æŸ¥å¸¸è§çš„ su æ–‡ä»¶è·¯å¾„
   - `/system/bin/su`ã€`/system/xbin/su` ç­‰

2. **Root åº”ç”¨æ£€æµ‹**
   - æ£€æŸ¥æ˜¯å¦å®‰è£… SuperSUã€Magisk ç­‰åº”ç”¨
   - é€šè¿‡ PackageManager æŸ¥è¯¢åŒ…å

3. **ç³»ç»Ÿå±æ€§æ£€æµ‹**
   - æ£€æŸ¥ `ro.build.tags` æ˜¯å¦åŒ…å« `test-keys`
   - æ£€æŸ¥ `ro.debuggable` å’Œ `ro.secure` å±æ€§

### æ¨¡æ‹Ÿå™¨æ£€æµ‹åŸç†

1. **Build ä¿¡æ¯æ£€æµ‹**
   - æ£€æŸ¥ `Build.MODEL`ã€`Build.MANUFACTURER` ç­‰
   - æ¨¡æ‹Ÿå™¨é€šå¸¸åŒ…å« `sdk`ã€`Emulator` ç­‰å…³é”®è¯

2. **ç¡¬ä»¶ç‰¹å¾æ£€æµ‹**
   - æ£€æŸ¥ CPU æ¶æ„ï¼ˆx86 é€šå¸¸æ˜¯æ¨¡æ‹Ÿå™¨ï¼‰
   - æ£€æŸ¥ç¡¬ä»¶åç§°ï¼ˆgoldfishã€vbox86ç­‰ï¼‰

3. **æ–‡ä»¶ç‰¹å¾æ£€æµ‹**
   - æ£€æŸ¥ `/dev/socket/qemud` ç­‰QEMUç‰¹å¾æ–‡ä»¶

### Hook æ¡†æ¶æ£€æµ‹åŸç†

1. **å †æ ˆæ£€æµ‹**
   - æŠ›å‡ºå¼‚å¸¸å¹¶æ£€æŸ¥å †æ ˆä¿¡æ¯
   - æŸ¥æ‰¾ Xposedã€Substrate ç‰¹å¾

2. **å†…å­˜æ£€æµ‹**
   - è¯»å– `/proc/self/maps`
   - æŸ¥æ‰¾ Hook æ¡†æ¶ç›¸å…³çš„åº“æ–‡ä»¶

3. **ç«¯å£æ£€æµ‹**
   - æ£€æŸ¥ Frida é»˜è®¤ç«¯å£ 27042

## æœ€ä½³å®è·µ

### 1. åº”ç”¨å¯åŠ¨æ£€æµ‹

```java
public class SplashActivity extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        
        // æ˜¾ç¤ºå¯åŠ¨ç”»é¢
        setContentView(R.layout.activity_splash);
        
        // æ‰§è¡Œå®‰å…¨æ£€æµ‹
        performSecurityCheck();
    }
    
    private void performSecurityCheck() {
        SecurityDetector detector = new SecurityDetector(this, 
            new SecurityDetector.SecurityCallback() {
            
            @Override
            public void onThreatDetected(String type, String desc, int level) {
                // è®°å½•å¨èƒ
            }
            
            @Override
            public void onDetectionComplete(boolean passed, 
                                           List<DetectionResult> threats) {
                if (passed || canContinueWithWarning(threats)) {
                    // è¿›å…¥ä¸»ç•Œé¢
                    startMainActivity();
                } else {
                    // æ˜¾ç¤ºé”™è¯¯å¹¶é€€å‡º
                    showSecurityErrorAndExit(threats);
                }
            }
        });
        
        detector.performSecurityCheck();
    }
}
```

### 2. å…³é”®æ“ä½œå‰æ£€æµ‹

```java
public class PaymentActivity extends Activity {
    
    private void processPayment() {
        // æ”¯ä»˜å‰è¿›è¡Œå®‰å…¨æ£€æµ‹
        SecurityDetector detector = new SecurityDetector(this, null);
        detector.performSecurityCheck();
        
        int score = detector.getSecurityScore();
        if (score < 80) {
            // å®‰å…¨åˆ†æ•°è¿‡ä½ï¼Œæ‹’ç»æ”¯ä»˜
            showDialog("å®‰å…¨ç¯å¢ƒå¼‚å¸¸ï¼Œæ— æ³•å®Œæˆæ”¯ä»˜");
            return;
        }
        
        // ç»§ç»­æ”¯ä»˜æµç¨‹
        continuePayment();
    }
}
```

### 3. æœåŠ¡å™¨éªŒè¯ç»“åˆ

```java
public class ServerVerification {
    
    public void submitSecurityReport(Context context) {
        SecurityDetector detector = new SecurityDetector(context, null);
        detector.performSecurityCheck();
        
        // è·å–æ£€æµ‹ç»“æœ
        Map<String, DetectionResult> results = detector.getResults();
        
        // æ„é€ ä¸ŠæŠ¥æ•°æ®
        JSONObject reportData = new JSONObject();
        for (Map.Entry<String, DetectionResult> entry : results.entrySet()) {
            DetectionResult result = entry.getValue();
            JSONObject item = new JSONObject();
            item.put("detected", result.detected);
            item.put("riskLevel", result.riskLevel);
            item.put("details", result.details);
            reportData.put(entry.getKey(), item);
        }
        
        // ä¸ŠæŠ¥åˆ°æœåŠ¡å™¨
        uploadToServer(reportData);
    }
    
    private void uploadToServer(JSONObject data) {
        // è°ƒç”¨æœåŠ¡å™¨ API
        // POST /api/security/report
    }
}
```

## æ€§èƒ½ä¼˜åŒ–

### 1. å¼‚æ­¥æ£€æµ‹

æ‰€æœ‰æ£€æµ‹éƒ½åœ¨åå°çº¿ç¨‹æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼š

```java
// SecurityDetector å†…éƒ¨å·²ç»ä½¿ç”¨äº† Thread
securityDetector.performSecurityCheck();
// ä¸ä¼šé˜»å¡ï¼Œç»“æœé€šè¿‡å›è°ƒè¿”å›
```

### 2. æŒ‰éœ€æ£€æµ‹

```java
// åªæ£€æµ‹éœ€è¦çš„é¡¹ç›®
if (needRootCheck) {
    RootDetector detector = new RootDetector(context);
    detector.isDeviceRooted();
}

if (needHookCheck) {
    HookDetector detector = new HookDetector(context);
    detector.detectHookFramework();
}
```

### 3. ç¼“å­˜ç»“æœ

```java
public class SecurityCache {
    private static Map<String, Boolean> cache = new HashMap<>();
    private static long lastCheckTime = 0;
    private static final long CACHE_DURATION = 5 * 60 * 1000; // 5åˆ†é’Ÿ
    
    public static boolean isDeviceRooted(Context context) {
        long now = System.currentTimeMillis();
        if (now - lastCheckTime < CACHE_DURATION && cache.containsKey("root")) {
            return cache.get("root");
        }
        
        RootDetector detector = new RootDetector(context);
        boolean result = detector.isDeviceRooted();
        
        cache.put("root", result);
        lastCheckTime = now;
        
        return result;
    }
}
```

## å¸¸è§é—®é¢˜

### Q1: æ£€æµ‹ä¼šå½±å“åº”ç”¨æ€§èƒ½å—ï¼Ÿ

A: ä¸ä¼šã€‚æ‰€æœ‰æ£€æµ‹éƒ½åœ¨åå°çº¿ç¨‹æ‰§è¡Œï¼Œå®Œæ•´æ£€æµ‹è€—æ—¶çº¦ 100-500msï¼Œå¯¹ç”¨æˆ·ä½“éªŒå½±å“æå°ã€‚

### Q2: å¦‚ä½•å¤„ç†è¯¯æŠ¥ï¼Ÿ

A: 
1. æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´é£é™©ç­‰çº§é˜ˆå€¼
2. æŸäº›æ£€æµ‹é¡¹ï¼ˆå¦‚æ¨¡æ‹Ÿå™¨ï¼‰å¯è®¾ä¸ºä»…è®°å½•
3. ç»“åˆæœåŠ¡å™¨ç«¯éªŒè¯æé«˜å‡†ç¡®æ€§

### Q3: æ£€æµ‹å¯ä»¥è¢«ç»•è¿‡å—ï¼Ÿ

A: ä»»ä½•å®¢æˆ·ç«¯æ£€æµ‹éƒ½å¯èƒ½è¢«ç»•è¿‡ã€‚å»ºè®®ï¼š
- å¤šé‡æ£€æµ‹æé«˜ç»•è¿‡éš¾åº¦
- é…åˆä»£ç æ··æ·†å’ŒåŠ å›º
- é‡è¦æ“ä½œå¿…é¡»ç»è¿‡æœåŠ¡å™¨éªŒè¯

### Q4: éœ€è¦å“ªäº›æƒé™ï¼Ÿ

A: å¤§éƒ¨åˆ†æ£€æµ‹ä¸éœ€è¦é¢å¤–æƒé™ã€‚ç‰¹æ®Šæƒ…å†µï¼š
- ä»£ç†æ£€æµ‹éœ€è¦ `ACCESS_NETWORK_STATE`
- å»ºè®®æ·»åŠ ï¼š`android.permission.INTERNET`ï¼ˆä¸ŠæŠ¥æ•°æ®ï¼‰

### Q5: å¦‚ä½•è·å–åº”ç”¨ç­¾åï¼Ÿ

```java
// æ–¹æ³•1ï¼šè¿è¡Œæ—¶è·å–
SignatureValidator validator = new SignatureValidator(context);
String sig = validator.getCurrentSignatureSHA256();
Log.i("Signature", sig);

// æ–¹æ³•2ï¼šä½¿ç”¨ keytool
// keytool -list -v -keystore your.keystore
```

### Q6: å‘å¸ƒç‰ˆæœ¬å¦‚ä½•é…ç½®ï¼Ÿ

```java
// 1. è·å–æ­£å¼ç­¾å
String releaseSignature = "YOUR_RELEASE_SIGNATURE_SHA256";

// 2. é…ç½®ç­¾åéªŒè¯
SignatureValidator validator = new SignatureValidator(context);
validator.setExpectedSignature(releaseSignature);

// 3. ä¸¥æ ¼æ¨¡å¼
if (!validator.verifySignature()) {
    // ç­¾åå¼‚å¸¸ï¼Œç«‹å³é€€å‡º
    android.os.Process.killProcess(android.os.Process.myPid());
}
```

### Q7: å¦‚ä½•ä¸æœåŠ¡å™¨é…åˆï¼Ÿ

```java
// å®¢æˆ·ç«¯ä¸ŠæŠ¥æ£€æµ‹ç»“æœ
securityDetector.performSecurityCheck();
String report = securityDetector.generateSecurityReport();
uploadToServer(report);

// æœåŠ¡å™¨ç«¯éªŒè¯
// 1. è®°å½•å¼‚å¸¸è®¾å¤‡
// 2. ç»“åˆè¡Œä¸ºåˆ†æ
// 3. å¿…è¦æ—¶å°ç¦è´¦å·
```

### Q8: æµ‹è¯•ç¯å¢ƒå¦‚ä½•å¤„ç†ï¼Ÿ

```java
public class SecurityConfig {
    public static boolean isDebugMode() {
        return BuildConfig.DEBUG;
    }
    
    public static void performSecurityCheck(Context context) {
        if (isDebugMode()) {
            // æµ‹è¯•ç¯å¢ƒï¼šå®½æ¾æ¨¡å¼
            Log.d("Security", "Debugæ¨¡å¼ï¼Œè·³è¿‡éƒ¨åˆ†æ£€æµ‹");
            return;
        }
        
        // æ­£å¼ç¯å¢ƒï¼šä¸¥æ ¼æ£€æµ‹
        SecurityDetector detector = new SecurityDetector(context, callback);
        detector.performSecurityCheck();
    }
}
```

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- [README.md](README.md) - å¿«é€Ÿå¼€å§‹
- [ç¤ºä¾‹ä»£ç ](src/main/java/game/app/anticheat/AntiCheatExample.java)

---

**æœ€åæ›´æ–°:** 2025-01-01  
**ç‰ˆæœ¬:** 1.0.0

